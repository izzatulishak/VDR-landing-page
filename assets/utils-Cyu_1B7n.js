const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-Dl02IgM2.js","assets/index-B68yOyRT.js","assets/index-BKTKGLs8.css"])))=>i.map(i=>d[i]);
import{aS as b,x as s,iN as d,iO as m,iP as w,iQ as k,iR as g,c as L}from"./index-B68yOyRT.js";import{S as v,u as z}from"./cimSymbolUtils-B9SGN5wL.js";new b(1e3);new s([128,128,128]);function I(n){if(n==null||!("symbolLayers"in n)||n.symbolLayers==null)return!1;switch(n.type){case"point-3d":return n.symbolLayers.some(l=>l.type==="object");case"line-3d":return n.symbolLayers.some(l=>l.type==="path");case"polygon-3d":return n.symbolLayers.some(l=>l.type==="object"||l.type==="extrude");default:return!1}}function J(n){var l;return((l=n.resource)==null?void 0:l.href)??""}function M(n,l){if(!n)return null;let r=null;return d(n)?r=S(n):m(n)&&(r=n.type==="cim"?z(n):n.color?new s(n.color):null),r?u(r,l):null}function S(n){const l=n.symbolLayers;if(!l)return null;let r=null;return l.forEach(e=>{var t;e.type==="object"&&((t=e.resource)!=null&&t.href)||(r=e.type==="water"?e.color:e.material?e.material.color:null)}),r?new s(r):null}function u(n,l){if(l==null||n==null)return n;const r=n.toRgba();return r[3]=r[3]*l,new s(r)}function x(n,l,r){const e=n.symbolLayers;if(!e)return;const t=(o,c=!1)=>{let a=l??o??null;return(r==null?void 0:r.override)!=null&&(!a&&c&&(a=new s([255,255,255])),a&&(a.a=r.override)),u(a,r==null?void 0:r.add)};e.forEach(o=>{var i,f;if(o.type==="water")return void(o.color=u(o.color,r==null?void 0:r.add));const c=o.material!=null?o.material.color:null,a=t(c,o.type==="icon"&&((i=o.resource)==null?void 0:i.href)!=null);o.material==null?o.material=new w({color:a}):o.material.color=a,"outline"in o&&((f=o.outline)!=null&&f.color)&&(r==null?void 0:r.add)!=null&&(o.outline.color=u(o.outline.color,r.add)),"marker"in o&&o.marker!=null&&(o.marker.color=t(o.marker.color))})}function _(n,l,r){var e;l=l??n.color,(r==null?void 0:r.override)!=null&&l&&(l.a=r.override),l&&(n.color=u(l,r==null?void 0:r.add)),"outline"in n&&((e=n.outline)!=null&&e.color)&&(n.outline.color=u(n.outline.color,r==null?void 0:r.add))}function Q(n,l,r){n&&(l||r!=null)&&(l&&(l=new s(l)),d(n)?x(n,l,r):m(n)&&_(n,l,r))}async function j(n,l){const r=n.symbolLayers;r&&await k(r,async e=>E(e,l))}async function E(n,l){switch(n.type){case"extrude":$(n,l);break;case"icon":case"line":case"text":R(n,l);break;case"path":P(n,l);break;case"object":await O(n,l)}}function R(n,l){const r=h(l);r!=null&&(n.size=r)}function h(n){for(const l of n)if(typeof l=="number")return l;return null}function $(n,l){const r=l[2];typeof r=="number"&&(n.size=r)}async function O(n,l){const{resourceSize:r,symbolSize:e}=await A(n),t=p(l,r,e);t!=null&&(n.width=y(l[0],e[0],r[0],t),n.depth=y(l[1],e[1],r[1],t),n.height=y(l[2],e[2],r[2],t))}function P(n,l){const r=p(l,g,[n.width,void 0,n.height]);r!=null&&(n.width=y(l[0],n.width,1,r),n.height=y(l[2],n.height,1,r))}function p(n,l,r){for(let e=0;e<3;e++){const t=n[e];switch(t){case"symbol-value":{const o=r[e];return o!=null?o/l[e]:1}case"proportional":break;default:if(t&&l[e])return t/l[e]}}return null}async function A(n){const{computeObjectLayerResourceSize:l}=await L(()=>import("./symbolLayerUtils-Dl02IgM2.js"),__vite__mapDeps([0,1,2])),r=await l(n,10),{width:e,height:t,depth:o}=n,c=[e,o,t];let a=1;for(let i=0;i<3;i++){const f=c[i];if(f!=null){a=f/r[i];break}}for(let i=0;i<3;i++)c[i]==null&&(c[i]=r[i]*a);return{resourceSize:r,symbolSize:c}}function y(n,l,r,e){switch(n){case"proportional":return r*e;case"symbol-value":return l??r;default:return n}}function D(n,l){const r=h(l);if(r!=null)switch(n.type){case"simple-marker":n.size=r;break;case"picture-marker":{const e=n.width/n.height;e>1?(n.width=r,n.height=r*e):(n.width=r*e,n.height=r);break}case"simple-line":n.width=r;break;case"text":n.font.size=r}}async function T(n,l){if(n&&l)return d(n)?j(n,l):void(m(n)&&D(n,l))}function U(n,l,r){if(n&&l!=null){if(d(n)){const e=n.symbolLayers;e&&e.forEach(t=>{if(t.type==="object")switch(r){case"tilt":t.tilt=(t.tilt??0)+l;break;case"roll":t.roll=(t.roll??0)+l;break;default:t.heading=(t.heading??0)+l}t.type==="icon"&&(t.angle+=l)})}else if(m(n))switch(n.type){case"simple-marker":case"picture-marker":case"text":n.angle+=l;break;case"cim":v(n,l,!0)}}}function V(n){return n!=null&&n.type==="polygon-3d"&&n.symbolLayers.some(l=>l.type==="extrude")}export{V as A,Q as L,T as M,U as N,M as b,J as d,I as h};
