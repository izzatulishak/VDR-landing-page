const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/editingTools-DRpwJIyB.js","assets/index-ni2rzWLC.js","assets/index-BKTKGLs8.css","assets/SnappingVisualizer2D-Bk_qDelb.js","assets/euclideanLengthMeasurementUtils-CbJTY0GV.js","assets/utils-Bg6XC5aR.js","assets/geometry2dUtils-VLc1JMth.js","assets/geodeticLengthOperator-C80lUKRh.js","assets/geodeticCurveType-CirnHLSB.js","assets/SnappingContext-CylBL92C.js","assets/PointSnappingHint-Ca_N7kXX.js","assets/editPlaneUtils-CTWXNCLm.js","assets/SketchTooltipInfo-g8R4xkbP.js","assets/MeshTransform-2Ljbqt9j.js","assets/a11yUtils-CQ85ceaI.js","assets/getDefaultUnitForView-BKbqxZDJ.js","assets/quantityFormatUtils-DhZ-kl5m.js","assets/angularMeasurementUtils-DRgQzGba.js","assets/dehydratedFeatureComparison-DLy5ee-j.js","assets/createUtils-HanKD2JZ.js","assets/distanceOperator-CsyXQUx0.js","assets/Point2D-DFGf8HqH.js","assets/Distance2DCalculator-CXhBP-8I-5z_f92nU.js","assets/ProjectionTransformation-wd-F6JmR.js","assets/Envelope2D-B_zpPshd.js","assets/Transformation2D-BUe9nOQ-.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/apiConverter-f906xf8C.js","assets/jsonConverter-ARiBjMkh.js","assets/simplifyOperator-hAG8GWi-.js","assets/operatorSimplify-BHFE7NvE.js","assets/mat2d-M76pAJGs.js","assets/mat2df64-DFLy2zOC.js","assets/TooltipInfoWithCoordinates-DmZN0UCJ.js","assets/InteractiveToolBase-BL9zmkqp.js","assets/EditGeometryOperations-Dl7MX0Ln.js","assets/rotate-Dc5TjMTQ.js","assets/curveOperationUtils-hZ0YJkLG.js","assets/SketchOptions-BerwAmRf.js","assets/SnappingDragPipelineStep-Bd3DgPqw.js","assets/SnappingOperation-ChyRC8lc.js","assets/cimSymbolUtils-DHSWIwOY.js","assets/GraphicManipulator-BcrGS9Ts.js","assets/drawUtils-v17IwNaF.js","assets/editingTools-CZt8aswn.js","assets/TextOverlayItem-DfumidMc.js","assets/SnappingVisualizer3D-B3ZBDqPL.js","assets/ExtendedLineVisualElement-DGN_EriK.js","assets/EngineVisualElement-Cog6WeMZ.js","assets/VisualElement-Bimu3UHH.js","assets/LaserlinePath.glsl-DuHJMf1a.js","assets/PointVisualElement-E_nVOsmQ.js","assets/ShadedColorMaterial.glsl-C-lU4_wL.js","assets/line-C8w50dvY.js","assets/ColorMaterial.glsl-Qc818hya.js","assets/TriangleMaterial-Bw9MxjhZ.js","assets/settings-C3LpjhMP.js","assets/lineStippleUtils-C89mzWlO.js","assets/OutlineVisualElement-CXHlxXk8.js","assets/line-DPe4dlij.js","assets/triangulationUtils-7soa12rR.js","assets/earcut-D9gy186-.js","assets/deduplicate-tjYcHOk_.js","assets/VerticesVisualElement-BZzUDrSM.js","assets/SelectedVertexTooltipInfo-DYDqvbl9.js","assets/IViewEvents-BB2zIsoP.js","assets/MoveManipulation-ByLcqRpt.js","assets/dragEventPipeline3D-YNIuKqMf.js","assets/TranslateTooltipInfo-DXG_gNTA.js","assets/utils-mmFyLdST.js","assets/SlicePlaneMaterial.glsl-BucN9mU6.js","assets/sliceToolConfig-DlZb502H.js","assets/DefaultLayouts-CxecuD51.js","assets/Factory-CxQZ1UdV.js","assets/RotateManipulator-CbzvFM8x.js","assets/ImageMaterial.glsl-UwAcxbTL.js","assets/ExtentScaleTooltipInfo-MTsodQem.js","assets/GraphicsLayerView3D-C6QsFyeL.js","assets/LayerView3D-Buags_3N.js","assets/queryForSymbologySnapping-X0CfVirV.js","assets/GraphicsProcessor-BzykwBif.js","assets/renderingInfoUtils-D8yjgXn2.js","assets/ExtentSet-BG8NJdaP.js","assets/optimizedFeatureQueryEngineAdapter-CEcjarXu.js","assets/popupUtils-DIiqLH9g.js","assets/Graphics3DObjectStates-VQJKdDoK.js","assets/highlightUtils-DmnCMSTT.js","assets/LayerView-pJmGdNcR.js","assets/highlightOptionsUtils-D4C-JZXx.js","assets/GraphicMover-B975Ph1e.js","assets/Box-Dol9d3rb.js","assets/settings-BiCM90ax.js","assets/automaticAreaMeasurementUtils-C2yxKhdH.js","assets/geodesicAreaMeasurementUtils-JfqvxXGJ.js","assets/automaticLengthMeasurementUtils-COC7hISw.js","assets/Reshape-DPkvXE2a.js","assets/symbolUtils-DzGYwoA1.js","assets/mat2df32-Dpt2CT5P.js"])))=>i.map(i=>d[i]);
import{aT as _e,bB as ce,at as fe,fr as B,sX as Y,bF as be,bZ as Z,sY as we,pH as Ge,sZ as Oe,pI as Te,c2 as W,_ as c,m as y,is as Ee,c1 as de,b as V,mP as Se,h as Ae,hk as J,v as Ce,hl as Me,s_ as ke,O as Q,s$ as He,E as Ie,K as H,N as D,S as Re,u as P,c as S,g as De,cF as j,aC as Pe,J as xe,ia as Ue,ib as Le,gz as $e,t0 as Fe,t1 as Ve,as as je,mQ as O,mR as X,q1 as b,t2 as A,hm as ee,ax as Ke,s as Ze,bR as te,ik as We,ek as ae,ro as I}from"./index-ni2rzWLC.js";import{l as ue,e as qe,c as Ne,r as ze,n as Be}from"./SketchOptions-BerwAmRf.js";import{u as ye,q as oe,a2 as Ye}from"./euclideanLengthMeasurementUtils-CbJTY0GV.js";import{u as x}from"./automaticAreaMeasurementUtils-C2yxKhdH.js";import{c as k}from"./automaticLengthMeasurementUtils-COC7hISw.js";let lt=class{constructor(){this._currentOperationSignal=_e(null)}get currentOperationType(){var t;return((t=this._currentOperationSignal.value)==null?void 0:t.type)??null}destroy(){this.stop()}async start(t,a,o){const i=this._currentOperationSignal.value;i==null||i.stop();const r=new AbortController,d=o==null?void 0:o.signal,h=AbortSignal.any([r.signal,d].filter(ce)),n=fe();let s=!1;const v=()=>{s||(s=!0,n.reject(Z()))},l={type:t,resolve:p=>{s||(s=!0,n.resolve(p))},reject:v,promise:n.promise,stop:()=>r.abort(),handles:[]};this._currentOperationSignal.value=l,l.handles.push(B(d,()=>{r.abort()}),B(h,()=>{Y(l.handles),s||v()}));try{return i&&(await i.promise.catch(()=>{}),be(h)),await a(l,h),await n.promise}finally{Y(l.handles),this._currentOperationSignal.value===l&&(this._currentOperationSignal.value=null)}}stop(){var t;(t=this._currentOperationSignal.value)==null||t.stop()}};function ie(e){switch(e){case 0:break;case 1:return"not owned by a graphics layer";case 2:return"no geometry";case 3:return"the geometry type is not supported";case 4:return"the symbol type is not supported"}return""}function Je(e){return Qe(e).result}function Qe(e){var o;if(e.graphic&&((o=e.graphic.layer)==null?void 0:o.type)!=="graphics")return{result:1};if(!e.operations)return{result:2};const t=e.operations.data.type,a=e.operations.data.geometry;return t==="point"||t==="mesh"||t==="polyline"||t==="polygon"?{result:0,geometry:a}:{result:3}}function Xe(e){var a;if(((a=e.layer)==null?void 0:a.type)!=="graphics")return 1;if(e.geometry==null)return 2;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return 0;default:return 3}const t=e.symbol!=null&&e.symbol.type==="point-3d"&&e.symbol.symbolLayers;return t&&t.some(o=>o.type==="object")?0:4}function re(e,t,a){if(!t||!(e!=null&&e.map))return;const{map:o}=e;o.layers.find(r=>r===t)||o.add(t,a)}function ct(e,t){const a=(t==null?void 0:t.type)==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(o=>{const i=o.layer;return i===a||"sublayers"in i&&i.sublayers!=null&&i.sublayers.includes(a)})}function dt(e){return we(e)||Ge(e)||Oe(e)||Te(e)}class me{constructor(t){this.layer=t}get elevationInfo(){return this.layer.elevationInfo}add(t){this.layer.add(t)}addMany(t){this.layer.addMany(t)}onGraphicsChange(t){const{layer:a}=this;return W(()=>a.graphics,"change",o=>t(o))}has(t){return t.layer===this.layer}remove(t){this.layer.remove(t)}removeMany(t){this.layer.removeMany(t)}removeAll(){this.layer.removeAll()}}c([y()],me.prototype,"elevationInfo",null);class ge{constructor(t){this.layer=t}get elevationInfo(){}add(t,a){const o=this._getSublayerForCreateTool(a)??this._getSublayerForGraphic(t);o==null||o.add(t)}addMany(t,a){if(a){const o=this._getSublayerForCreateTool(a);if(o)return void o.addMany(t)}t.forEach(o=>{var i;return(i=this._getSublayerForGraphic(o))==null?void 0:i.add(o)})}onGraphicsChange(t){var o,i;const{layer:a}=this;if((o=a.sublayers)!=null&&o.length)return Ee((i=a.sublayers)==null?void 0:i.toArray().map(r=>W(()=>r.graphics,"change",d=>t(d))))}has(t){var o;const{layer:a}=this;return t.layer===a||t.sourceLayer===a||!!((o=a.sublayers)!=null&&o.some(i=>t.layer===i||t.sourceLayer===i))}remove(t){var a;(a=this._getSublayerForGraphic(t))==null||a.remove(t)}removeMany(t){t.forEach(a=>{var o;return(o=this._getSublayerForGraphic(a))==null?void 0:o.remove(a)})}removeAll(){var t;(t=this.layer.sublayers)==null||t.forEach(a=>a.removeAll())}_getSublayerForCreateTool(t){const{layer:a}=this;switch(t){case"point":return a.pointLayer;case"polyline":return a.polylineLayer;case"polygon":return a.polygonLayer;case"multipoint":return a.multipointLayer;case"text":return a.textLayer}}_getSublayerForGraphic(t){var o;const{layer:a}=this;if(t!=null&&t.geometry)switch(t.geometry.type){case"point":return((o=t.symbol)==null?void 0:o.type)==="text"?a.textLayer:a.pointLayer;case"polyline":return a.polylineLayer;case"polygon":return a.polygonLayer;case"multipoint":return a.multipointLayer}}}c([y()],ge.prototype,"elevationInfo",null);let T=class extends de{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){var t;const{activeComponent:e}=this;if(!e)return null;switch(e.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":return((t=e.graphicSymbol)==null?void 0:t.type)==="text"?"text":e.geometryType;case"draw-3d":return e.geometryType}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var e;(e=this.activeComponent)==null||e.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};c([y()],T.prototype,"activeComponent",void 0),c([y()],T.prototype,"cancelled",void 0),c([y()],T.prototype,"history",void 0),c([y()],T.prototype,"tool",null),c([y()],T.prototype,"type",void 0),c([y()],T.prototype,"canUndo",null),c([y()],T.prototype,"canRedo",null),c([y()],T.prototype,"onEnd",void 0),c([y()],T.prototype,"undo",null),c([y()],T.prototype,"redo",null),c([y()],T.prototype,"toggleTool",void 0),c([y()],T.prototype,"addToSelection",void 0),c([y()],T.prototype,"removeFromSelection",void 0),T=c([V("esri.widgets.Sketch.support.OperationHandle")],T);let F=class extends T{};c([y()],F.prototype,"activeComponent",void 0),F=c([V("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],F);let C=class extends T{};c([y()],C.prototype,"activeComponent",void 0),C=c([V("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],C);function et(e,t){return t==="freehandPolygon"||t==="freehandPolyline"?"freehand":e??(t==="rectangle"||t==="circle"?"hybrid":"click")}function tt(e){switch(e){case"freehandPolygon":return"polygon";case"freehandPolyline":return"polyline";case"text":return"point";default:return e}}function se(e){var a;if(e.length>1)return!1;const t=(a=e.at(0))==null?void 0:a.geometry;return(t==null?void 0:t.type)==="point"||(t==null?void 0:t.type)==="multipoint"&&t.points.length<2}const ne={defaultZ:0},R={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0,name:Re},tool:"transform"},K=Symbol(),pe=Symbol();let _=class extends de{constructor(e){var t;super(e),this._defaultSnappingManager=null,this._internalGraphicsLayer=new Se({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._updatingHandles=new Ae,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new J({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Ce({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new Me({color:[130,130,130,1],width:2}),this.meshSymbol=new ke({symbolLayers:new Q([new He])}),this.textSymbol=new Ie({text:"text"}),this.updateGraphics=new Q,this.updateOnGraphicClick=!0,this.creationMode="single",this.vertexSymbol=new J({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new ue,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._sketchContinuationFlag=!1,this._onLayerAdapterChange=async()=>{const{_layerAdapter:a}=this;if(this.removeHandles(pe),!a)return;const o=[a.onGraphicsChange(i=>this._onLayerGraphicsChangeCallback(i)),H(()=>a.elevationInfo,i=>{i!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=i)},D)].filter(ce);this.addHandles(o,pe)},this._originalPopupEnabled=null,this.defaultCreateOptions=ne,this.defaultUpdateOptions=R,this.snappingOptions=((t=e==null?void 0:e.snappingManager)==null?void 0:t.options)??(e==null?void 0:e.snappingOptions)??new ye}initialize(){this.addHandles([W(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.layers},"change",e=>{this.layer&&e.removed.includes(this.layer)&&this.cancel()}),H(()=>this._layerAdapter,()=>this._onLayerAdapterChange(),D),H(()=>this.view,e=>{this._defaultSnappingManager=P(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new oe({view:e,options:this.snappingOptions})),e.type==="2d"?S(()=>import("./editingTools-DRpwJIyB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])):e.type==="3d"&&(S(()=>import("./editingTools-CZt8aswn.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,16,15,46,47,48,49,50,51,52,53,54,55,56,9,10,57,58,59,60,61,62,63,64,65,12,13,14,17,34,11,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,66,67,68,69,70,42,71,72,73,74,75,76,77,43])),S(()=>import("./GraphicsLayerView3D-C6QsFyeL.js"),__vite__mapDeps([78,1,2,79,80,81,82,83,84,85,86,87,88,89]))))},D),H(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})]),Ye(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=P(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this._updatingHandles.destroy(),this.emit("destroy")}get _layerAdapter(){const{layer:e}=this;switch(e==null?void 0:e.type){case"graphics":return new me(e);case"map-notes":return new ge(e);default:return null}}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeCreateToolDrawMode(){var e;return((e=this._operationHandle)==null?void 0:e.type)==="create"&&this._operationHandle.activeComponent&&"mode"in this._operationHandle.activeComponent?this._operationHandle.activeComponent.mode:null}get activeTooltip(){const{activeComponent:e,destroyed:t}=this,a=!t&&e&&"tooltip"in e?e.tooltip:null;return a!=null&&a.visible?a:null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...ne,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...R,...e,reshapeOptions:{...R.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...R.highlightOptions,...e==null?void 0:e.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){var e;return((e=this.snappingManager)==null?void 0:e.options)??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=P(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:t}=this;!this._defaultSnappingManager&&t&&(this._defaultSnappingManager=new oe({options:this.snappingOptions,view:t})),this._clearOverride("snappingManager")}}get state(){var a;const e=!(!((a=this.view)!=null&&a.ready)||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get updating(){var e;return!(!this._updatingHandles.updating&&!((e=this.snappingManager)!=null&&e.updating))}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:o,map:i}=t;o&&this._clearCursor(),i==null||i.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const a="view-ready";this.removeHandles(a),e&&this.addHandles(De(()=>e.ready,o=>{this.removeHandles(this._viewHandlesKey),o&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},D),a),this._set("view",e)}addGraphic(e){var t;(t=this._layerAdapter)==null||t.add(e)}addGraphics(e){var t;(t=this._layerAdapter)==null||t.addMany(e)}hasGraphic(e){var t;return!!((t=this._layerAdapter)!=null&&t.has(e))}removeGraphic(e){var t;(t=this._layerAdapter)==null||t.remove(e)}removeGraphics(e){var t;(t=this._layerAdapter)==null||t.removeMany(e)}removeAllGraphics(){var e;(e=this._layerAdapter)==null||e.removeAll()}cancel(){this._moduleLoaderAbortController=j(this._moduleLoaderAbortController),this._viewReadyAbortController=j(this._viewReadyAbortController),this._sketchContinuationFlag=!0,this._operationHandle&&this._operationHandle.cancel()}complete(){var e;(e=this._operationHandle)==null||e.complete()}delete(){const{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){const{activeTool:a}=this,o=t.toArray();this.removeGraphics(o),this.cancel(),this._emitDeleteEvent({graphics:o,tool:a})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(t=>t.clone()).toArray();return this.addGraphics(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){var d;this.cancel(),await this._waitViewReady();const{view:a,layer:o}=this;if(!a||this.state==="disabled")throw o||this._logMissingLayer(),Z();if(a.activeTool!=null&&(a.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");re(a,this._internalGraphicsLayer);const i=await this._updatingHandles.addPromise(this._setupCreateOperation(e,t));if(i==null||this.destroyed)return void((d=a.map)==null?void 0:d.remove(this._internalGraphicsLayer));const r=()=>{var h,n;if(i===this._operationHandle){const s=this.createGraphic,v=this._operationHandle.cancelled;if(this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(n=(h=this.view)==null?void 0:h.map)==null||n.remove(this._internalGraphicsLayer),i.cancelled||s==null||this.addGraphic(s),this._sketchContinuationFlag=!1,this.emit("create",{graphic:s,state:v?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"}),v||this._sketchContinuationFlag)return;const{creationMode:l}=this;if(l==="continuous"){if(t!=null&&t.geometryToPlace)return;this._updatingHandles.addPromise(ae(this.create(e,t)))}else l==="update"&&s&&this._updatingHandles.addPromise(ae(this.update([s])))}};i.on("complete",r),this._operationHandle=i,a.ready&&a.focus()}async place(e,t){return await e.load(),this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...t})}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:a,view:o,state:i}=this;if(!o||i==="disabled")throw a||this._logMissingLayer(),Z();o.activeTool!=null&&(o.activeTool=null);const r=Array.isArray(e)?e:[e];if(e==null||!(r!=null&&r.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(r.some(h=>this.hasGraphic(h)?h.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0)))return;const d=await this._updatingHandles.addPromise(this._setupUpdateOperation(r,t));this.destroyed||d==null||G(d)||(re(o,this._internalGraphicsLayer),this._setUpdateOperationHandle(d,t),this.emit("update",{graphics:r,state:"start",aborted:!1,tool:d.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){e=Array.isArray(e)?e:[e];for(const a of e)a.geometry==null||a.geometry.type==="mesh"||Pe(a.geometry.spatialReference,t.spatialReference)||(xe(a.geometry.spatialReference,t.spatialReference)||Ue()||await Le(),a.geometry=$e(a.geometry,t.spatialReference))}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){var e;return!!((e=this._operationHandle)!=null&&e.canUndo())}canRedo(){var e;return!!((e=this._operationHandle)!=null&&e.canRedo())}toggleUpdateTool(){var e;(e=this._operationHandle)==null||e.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if(t.type==="2d"){const i=[];t.map.allLayers.forEach(d=>{d.type!=="vector-tile"&&d.type!=="imagery"||i.push(d)});const r=await t.hitTest(e,{exclude:i});return Fe(r.results)}const a=[t.map.ground];t.map.allLayers.forEach(i=>{Ve(i)&&a.push(i)});const o=await t.hitTest(e,{exclude:a});if(o.results.length>0){const i=o.results[0];if(i!=null&&i.type==="graphic"&&i.graphic&&(!o.ground.mapPoint||t.map.ground.opacity<1||o.ground.distance-(i.distance??0)>-Math.min(3*o.ground.distance,t.viewingMode==="global"?je(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return i}return null}_generateViewHandles(e){return[e.on("immediate-click",async t=>{var o;const a=this.state==="active"&&((o=this._operationHandle)==null?void 0:o.type)==="create";this.state!=="disabled"&&!a&&this.updateOnGraphicClick&&await this._updatingHandles.addPromise(this._handleImmediateClick(t))},O.WIDGET)]}async _handleImmediateClick(e){var o;const t=await e.defer(()=>this._getFirstHit(X(e)));let a=null;if(t!=null){const i=t.graphic;this.updateGraphics.includes(i)||this.hasGraphic(i)?(e.stopPropagation(),a=i):((o=this.view)==null?void 0:o.type)!=="2d"||this._isComponentGraphic(i)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();a==null||this.updateGraphics.includes(a)||await this.update([a],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}})}async _setupCreateOperation(e,t){const a=this.view;if(!a)return this._logMissingView(),null;const o={hasZ:a.type==="3d",...this.defaultCreateOptions,...t},i=await this._setupDrawGraphicTool(e,a,o);return i==null?null:(a.tools.add(i),a.activeTool=i,this._setupCreateOperationHandle(i,e))}async _setupDrawGraphicTool(e,t,a){var g;if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const{cursor:o,defaultZ:i,hasZ:r,geometryToPlace:d,graphicProperties:h,mode:n,preserveAspectRatio:s}=a,v=et(n,e),l=tt(e),p=(g=a==null?void 0:a.optionsPerTool)!=null&&g.has(e)?a.optionsPerTool.get(e):{},m=(p==null?void 0:p.preserveAspectRatio)??s??e!=="rectangle",u={centered:e!=="rectangle"&&!(e==="circle"&&!m),cursor:o,defaultZ:i,forceUniformSize:m,graphicProperties:{...h,attributes:{...h==null?void 0:h.attributes}},geometryToPlace:d,geometryType:l,mode:v,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:r,snappingManager:this.snappingManager,snapToScene:!1,view:t,...p};return t.type==="2d"?this._makeDrawGraphicTool2D(u):this._makeDrawGraphicTool3D(u)}async _makeDrawGraphicTool2D(e){const[t,a,o]=await Promise.all([this._requireModule(S(()=>import("./editingTools-DRpwJIyB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]))),x(),k()]);return G(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ot(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:a,automaticLengthMeasurementUtils:o})}async _makeDrawGraphicTool3D(e){var i;const[t,a,o]=await Promise.all([this._requireModule(S(()=>import("./editingTools-CZt8aswn.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,16,15,46,47,48,49,50,51,52,53,54,55,56,9,10,57,58,59,60,61,62,63,64,65,12,13,14,17,34,11,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,66,67,68,69,70,42,71,72,73,74,75,76,77,43]))),x(),k()]);return G(t)||this.destroyed?null:new t.module.DrawGraphicTool3D({...e,elevationInfo:(i=this._layerAdapter)==null?void 0:i.elevationInfo,snapToScene:!0,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:a,automaticLengthMeasurementUtils:o})}_setupCreateOperationHandle(e,t){const a=this.view;if(!a)return this._logMissingView(),null;let o=null;const i=e.forceUniformSize,r=e.centered,d=[a.on("key-down",n=>{if(n.key===b.pan)n.stopPropagation(),n.repeat||(e.enabled=!1);else if(n.key===b.complete)n.stopPropagation(),e.completeCreateOperation();else if(n.key!==b.vertexAdd||n.repeat)n.key===b.undo?(n.stopPropagation(),h.undo()):n.key===b.redo?(n.stopPropagation(),h.redo()):n.key!==b.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||n.repeat?n.key===b.center&&(n.repeat||(e.centered=!r,n.stopPropagation())):(e.forceUniformSize=!i,n.stopPropagation());else{const s=e.drawOperation.geometryType;s!=="polyline"&&s!=="polygon"&&s!=="multipoint"||(n.stopPropagation(),e.drawOperation.commitStagedVertex())}},O.WIDGET),a.on("key-up",n=>{n.key===b.pan?e.enabled=!0:n.key!==b.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?n.key===b.center&&(e.centered=r,n.stopPropagation()):(e.forceUniformSize=i,n.stopPropagation())},O.WIDGET),e.on("vertex-add",n=>{switch(o=o==null?"start":"active",n.operation){case"apply":this.emit("create",{graphic:e.graphic,state:o,tool:this.activeTool,toolEventInfo:n,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",n=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:n.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",n=>{switch(n.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:n,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",n=>{this._set("createGraphic",n.graphic),o="complete",n.aborted?h&&h.cancel():h&&h.complete()}),H(()=>this._getGraphicSymbolFromTool(t),n=>{e.graphicSymbol=n})],h=new F({activeComponent:e,type:"create",onEnd:()=>{var n;A(d),(n=a.tools)==null||n.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return h}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":case"freehandPolyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":case"freehandPolygon":return this.polygonSymbol;case"mesh":return this.meshSymbol;case"text":return this.textSymbol}}async _setupUpdateOperation(e,t){const{view:a}=this;if(!a)return this._logMissingView(),null;const o={...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t==null?void 0:t.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...t==null?void 0:t.highlightOptions}};let i=o.tool??R.tool;if(this.removeGraphics(e),this.addGraphics(e),a.type==="3d"){if(e.length===0)return null;switch(i){case"move":return this._setupMove3DOperation(e,o,a,i);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],o,a);case"transform":return this._setupGraphicTransform3DOperation(e,o,a)}}switch(i){case"move":return this._setupMove2DOperation(e,o,a);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,i,o,a);case"transform":return se(e)&&(i="reshape"),this._setupTransformOrReshape2DOperation(e,i,o,a)}}async _setupMove3DOperation(e,t,a,o,i=!1){const[r,d]=await Promise.all([this._requireModule(S(()=>import("./editingTools-CZt8aswn.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,16,15,46,47,48,49,50,51,52,53,54,55,56,9,10,57,58,59,60,61,62,63,64,65,12,13,14,17,34,11,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,66,67,68,69,70,42,71,72,73,74,75,76,77,43]))),k()]);if(G(r))return r;const{ManipulatedObject3DGraphic:h,MoveTool3D:n}=r.module,s=new Map,v=()=>{s.forEach(u=>u.destroy()),s.clear()};for(const u of e){const g=new h({view:a,graphic:u}),f=qe(g);if(f!==0)return v(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${ie(f)}).`),null;s.set(u,g)}const l=new n({view:a,enableZ:t.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,autoLengthMeasurementUtils:d});a.tools.add(l),l.objects.addMany(Array.from(s.values())),i||this.updateGraphics.addMany(e);const p=[],m=new C({activeComponent:l,tool:o,type:"update",onEnd:()=>{A(p),$(a,l),v()},undo:()=>{he(this.view,l),U(m,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{L(m,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:u=>{this.updateGraphics.push(u);const g=new h({view:a,graphic:u});s.set(u,g),l.objects.push(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const g=this.updateGraphics.indexOf(u);if(m.history.undo.forEach(E=>E.updates.splice(g,1)),m.history.redo.forEach(E=>E.updates.splice(g,1)),this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void m.complete();const f=s.get(u);f&&(l.objects.remove(f),f.destroy(),s.delete(u))},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||o!=="transform")return;const u=this.updateGraphics.at(0),g=await this._setupReshape3DOperation(u,t,a,!0);g&&!G(g)&&(m.onEnd(),m.destroy(),this._setUpdateOperationHandle(g,t))}});return p.push(...this._getHandlesForComponent(m,t),a.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(m,u,t),O.WIDGET),a.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(m,u)},O.WIDGET)),m}_setupGraphicTransform3DOperation(e,t,a,o=!1){if(e.length===1&&Xe(e[0])===0){const i=e[0],r=i.geometry;if(r!=null&&(r.type==="point"||r.type==="mesh"))return this._setupPointTransform3DOperation(i,t,a);if(r!=null&&(r.type==="polygon"||r.type==="polyline"))return this._setupPolyTransform3DOperation(i,t,a,o)}return this._setupMove3DOperation(e,t,a,"transform",o)}async _setupPointTransform3DOperation(e,t,a){const o="transform",{enableRotation:i,enableScaling:r,enableZ:d}=t,h=await this._requireModule(S(()=>import("./editingTools-CZt8aswn.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,16,15,46,47,48,49,50,51,52,53,54,55,56,9,10,57,58,59,60,61,62,63,64,65,12,13,14,17,34,11,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,66,67,68,69,70,42,71,72,73,74,75,76,77,43])));if(G(h))return h;const{TransformTool3D:n,ManipulatedObject3DGraphic:s}=h.module,v=new s({graphic:e,view:a}),l=new n({object:v,view:a,enableRotation:i,enableScaling:r,enableZ:d,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});a.tools.add(l),this.updateGraphics.add(e);const p=[],m=new C({activeComponent:l,tool:o,type:"update",onEnd:()=>{A(p),$(a,l),v.destroy()},undo:()=>{he(this.view,l),U(m,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{L(m,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:async u=>{this.updateGraphics.add(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"}),m.onEnd(),m.destroy();const g=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,a,"transform",!0);G(g)||this._setUpdateOperationHandle(g,t)},removeFromSelection:u=>{this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),m.complete()},toggleTool:()=>{}});return p.push(...this._getHandlesForComponent(m,t),a.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(m,u,t),O.WIDGET),a.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(m,u)},O.WIDGET)),m}async _setupPolyTransform3DOperation(e,t,a,o=!1){var q,N;const i="transform",{enableRotation:r,enableScaling:d,enableZ:h,preserveAspectRatio:n}=t,[s,v]=await Promise.all([this._requireModule(S(()=>import("./editingTools-CZt8aswn.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,16,15,46,47,48,49,50,51,52,53,54,55,56,9,10,57,58,59,60,61,62,63,64,65,12,13,14,17,34,11,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,66,67,68,69,70,42,71,72,73,74,75,76,77,43]))),k()]);if(G(s))return s;const{ManipulatedObject3DGraphic:l,ExtentTransformTool:p}=s.module,m=(N=(q=this.view)==null?void 0:q.inputManager)==null?void 0:N.isModifierKeyDown(b.constraint),u=new l({view:a,graphic:e}),g=new p({object:u,view:a,enableRotation:r,enableScaling:d,enableZ:h,preserveAspectRatio:!!n!=!!m,sketchOptions:this.sketchOptions,automaticLengthMeasurementUtils:v});a.tools.add(g),o||this.updateGraphics.add(e);const f=[],E=new C({activeComponent:g,tool:i,type:"update",onEnd:()=>{A(f),$(a,g),u.destroy()},canUndo:()=>!g.destroyed&&g.canUndo,undo:()=>{g.destroyed||(g.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},canRedo:()=>!g.destroyed&&g.canRedo,redo:()=>{g.destroyed||(g.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},addToSelection:async w=>{this.updateGraphics.add(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[w],removed:[],type:"selection-change"},type:"update"}),E.onEnd(),E.destroy();const z=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,a,"transform",!0);G(z)||this._setUpdateOperationHandle(z,t)},removeFromSelection:w=>{this.updateGraphics.remove(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[w],type:"selection-change"},type:"update"}),E.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;const w=await this._setupReshape3DOperation(e,t,a,!0);w&&!G(w)&&(E.onEnd(),E.destroy(),this._setUpdateOperationHandle(w,t))}});return f.push(...this._getHandlesForComponent(E,t),a.on("immediate-click",w=>this._getCommonUpdateOperationClickHandlers(E,w,t),O.WIDGET),a.on("key-down",w=>this._getCommonUpdateOperationKeyDownHandlers(E,w),O.WIDGET),a.on("key-down",w=>{w.key!==b.constraint||w.repeat||(g.preserveAspectRatio=!g.preserveAspectRatio,w.stopPropagation())},O.WIDGET),a.on("key-up",w=>{w.key===b.constraint&&(g.preserveAspectRatio=!g.preserveAspectRatio,w.stopPropagation())},O.WIDGET)),E}async _setupMove2DOperation(e,t,a){const o="move";this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const i=await this._getGraphicMover(e,t,a);if(G(i))return i;const r=new C({activeComponent:i,tool:o,type:"update",onEnd:()=>{var s;this._clearCursor(),A(n),A(h),i.destroy(),(s=this._internalGraphicsLayer)==null||s.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const s=this.updateGraphics.toArray();U(r,s),r.refreshComponent(),this._emitUndoEvent({graphics:s,tool:o})},redo:()=>{const s=this.updateGraphics.toArray();L(r,s),r.refreshComponent(),this._emitRedoEvent({graphics:s,tool:o})},addToSelection:async s=>{await this._updatingHandles.addPromise(this._updateSpatialReference(s)),this.updateGraphics.push(s),i.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[s],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:s=>{const v=this.updateGraphics.indexOf(s);r.history.undo.forEach(p=>p.updates.splice(v,1)),r.history.redo.forEach(p=>p.updates.splice(v,1)),this.updateGraphics.remove(s);const l=this.updateGraphics.toArray();this.emit("update",{graphics:l,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[s],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?i.graphics=l:r.complete()}});let d=!1;const h=[a.on("immediate-click",s=>this._getCommonUpdateOperationClickHandlers(r,s,t),O.WIDGET),a.on("key-down",s=>{this._getCommonUpdateOperationKeyDownHandlers(r,s),s.key!==b.constraint||s.repeat||(d=!0,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},O.WIDGET),a.on("key-up",s=>{s.key===b.constraint&&d&&(d=!1,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},O.WIDGET)],n=this._getHandlesForComponent(r,t);return r}async _setupReshape3DOperation(e,t,a,o=!1){const i="reshape",[r,d,h]=await Promise.all([this._requireModule(S(()=>import("./editingTools-CZt8aswn.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,16,15,46,47,48,49,50,51,52,53,54,55,56,9,10,57,58,59,60,61,62,63,64,65,12,13,14,17,34,11,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,66,67,68,69,70,42,71,72,73,74,75,76,77,43]))),x(),k()]);if(G(r))return r;const{ManipulatedObject3DGraphic:n,ReshapeTool3D:s}=r.module,v=new n({view:a,graphic:e}),l=Je(v);if(l!==0)return v.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${ie(l)}).`),null;const p=t.reshapeOptions,m=new s({view:a,object:v,enableZVertex:t.enableZ&&(p==null?void 0:p.vertexOperation)==="move",enableZShape:t.enableZ&&(p==null?void 0:p.shapeOperation)==="move",enableMoveObject:(p==null?void 0:p.shapeOperation)==="move"||(p==null?void 0:p.shapeOperation)==="move-xy",enableMidpoints:(p==null?void 0:p.edgeOperation)==="split",enableEdgeOffset:(p==null?void 0:p.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:d,automaticLengthMeasurementUtils:h});a.tools.add(m),o||this.updateGraphics.add(v.graphic);const u=[],g=new C({activeComponent:m,tool:i,type:"update",onEnd:()=>{A(u),$(a,m),v.destroy()},canUndo:()=>!m.destroyed&&m.canUndo,undo:()=>{m.destroyed||(m.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},canRedo:()=>!m.destroyed&&m.canRedo,redo:()=>{m.destroyed||(m.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},addToSelection:async f=>{this.updateGraphics.add(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[f],removed:[],type:"selection-change"},type:"update"}),g.onEnd(),g.destroy();const E=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,a,"transform",!0);G(E)||this._setUpdateOperationHandle(E,t)},removeFromSelection:f=>{this.updateGraphics.remove(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[f],type:"selection-change"},type:"update"}),g.complete()},toggleTool:async()=>{if(t.toggleToolOnClick===!1)return;g.onEnd(),g.destroy();const f=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,a,!0);G(f)||this._setUpdateOperationHandle(f,t)}});return u.push(...this._getHandlesForComponent(g,t),a.on("immediate-click",f=>this._getCommonUpdateOperationClickHandlers(g,f,t),O.WIDGET),a.on("key-down",f=>{this._getCommonUpdateOperationKeyDownHandlers(g,f)},O.WIDGET)),g}async _setupTransformOrReshape2DOperation(e,t,a,o){this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const i=t==="transform"?await this._getBox(e,a,o):await this._getReshape(e,a,o);if(G(i))return i;const r=new C({activeComponent:i,type:"update",onEnd:()=>{A(h),A(d),r.activeComponent&&!r.activeComponent.destroyed&&r.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{U(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},redo:()=>{L(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},addToSelection:async n=>{let s=r.activeComponent;if((s==null?void 0:s.type)==="reshape"){const v=[...this.updateGraphics,n];this.updateGraphics.removeAll(),r.onEnd(),r.destroy();const l=await this._setupTransformOrReshape2DOperation(v,"transform",a,o);if(G(l))return;this._setUpdateOperationHandle(l,a)}else this.updateGraphics.add(n),s.graphics=this.updateGraphics.toArray(),s.refresh(),r.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const s=this.updateGraphics.indexOf(n);r.history.undo.forEach(l=>l.updates.splice(s,1)),r.history.redo.forEach(l=>l.updates.splice(s,1)),this.updateGraphics.remove(n);const v=this.updateGraphics.toArray();v.length===0?r.complete():se(v)?r.toggleTool():r.activeComponent.graphics=v,this.emit("update",{graphics:v,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"})},toggleTool:async()=>{var l;if(this.updateGraphics.length>1)return;const n=this.updateGraphics.at(0),s=n.geometry;if(s!=null&&(r.tool==="reshape"&&s.type==="point"||r.tool==="transform"&&s.type==="extent"))return;let v=null;r.tool==="transform"?v=await this._getReshape([n],a,o):r.tool==="reshape"&&(v=await this._getBox([n],a,o)),G(v)||((l=r.activeComponent)==null||l.destroy(),r.activeComponent=v,r.activeComponent&&(A(h),h=this._getHandlesForComponent(r,a)))}}),d=[o.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(r,n,a),O.WIDGET),o.on("key-down",n=>{if(this._getCommonUpdateOperationKeyDownHandlers(r,n),n.key===b.constraint&&!n.repeat&&r){const s=r.activeComponent;s&&s.type==="box"&&(s.preserveAspectRatio=!s.preserveAspectRatio)}},O.WIDGET),o.on("key-up",n=>{if(n.key===b.constraint&&r){const s=r.activeComponent;s&&s.type==="box"&&(s.preserveAspectRatio=!s.preserveAspectRatio)}},O.WIDGET)];let h=this._getHandlesForComponent(r,a);return r}async _getGraphicMover(e,t,a){const{enableMoveAllGraphics:o,highlightOptions:i}=t,r=await this._requireModule(S(()=>import("./GraphicMover-B975Ph1e.js").then(d=>d.G),__vite__mapDeps([90,1,2,44,38,43])));return G(r)?r:new r.module.default({enableMoveAllGraphics:o,highlightName:i==null?void 0:i.name,highlightsEnabled:!!(i!=null&&i.enabled),indicatorsEnabled:!1,graphics:e,view:a,callbacks:{onGraphicMoveStart:({dx:d,dy:h,graphic:n})=>{this._displayCursor("grabbing"),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:h,mover:n,type:"move-start"},type:"update"})},onGraphicMove:({dx:d,dy:h,graphic:n})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:h,mover:n,type:"move"},type:"update"}),onGraphicMoveStop:({dx:d,dy:h,graphic:n})=>{this._displayCursor("pointer"),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:h,mover:n,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayCursor("move"),onGraphicPointerOut:()=>this._clearCursor()}})}async _getBox(e,t,a){var v,l;const{enableRotation:o,enableScaling:i,highlightOptions:r,preserveAspectRatio:d}=t,[h,n]=await Promise.all([this._requireModule(S(()=>import("./Box-Dol9d3rb.js"),__vite__mapDeps([91,1,2,37,44,38,90,43,92,39,12,13,14,15,16,17,4,5,6,7,8,77,69,93,94,62,95]))),k()]);if(G(h))return h;const s=(l=(v=this.view)==null?void 0:v.inputManager)==null?void 0:l.isModifierKeyDown(b.constraint);return new h.module.default({graphics:e,enableRotation:o,enableScaling:i,highlightName:r==null?void 0:r.name,highlightsEnabled:!!(r!=null&&r.enabled),preserveAspectRatio:!!d!=!!s,layer:this._internalGraphicsLayer,view:a,sketchOptions:this.sketchOptions,automaticLengthMeasurementUtils:n,callbacks:{onMoveStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onMove:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onMoveStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScaleStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScale:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScaleStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotateStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotate:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotateStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"})}})}async _getReshape(e,t,a){const{highlightOptions:o,reshapeOptions:i}=t,r=(i==null?void 0:i.edgeOperation)==="split",d=(i==null?void 0:i.shapeOperation)==="move",h=!!(i!=null&&i.enableCreateCurveFromStraightEdge),[n,s,v]=await Promise.all([this._requireModule(S(()=>import("./Reshape-DPkvXE2a.js"),__vite__mapDeps([96,1,2,28,21,24,23,25,26,27,29,3,4,5,6,7,8,9,10,97,70,42,98,32,65,12,13,14,15,16,17,34,44,38,90,43,69,92,36,37,39,93,94,62,95]))),x(),k()]);return G(n)?n:new n.module.default({enableMidpoints:r,enableMovement:d,enableCurveOnMidpoint:h,graphic:e[0],highlightName:o==null?void 0:o.name,highlightsEnabled:!!(o!=null&&o.enabled),layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:s,automaticLengthMeasurementUtils:v,view:a,callbacks:{onReshapeStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onReshape:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onReshapeStop:({mover:l,type:p})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:l,type:p},type:"update"}),onMoveStart:({dx:l,dy:p,mover:m,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:m,type:u},type:"update"}),onMove:({dx:l,dy:p,mover:m,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:m,type:u},type:"update"}),onMoveStop:({dx:l,dy:p,mover:m,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:m,type:u},type:"update"}),onVertexAdd:({added:l,type:p,vertices:m})=>{const u=l.map(g=>ee(g.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:u,vertices:m,type:p},type:"update"})},onVertexRemove:({removed:l,type:p,vertices:m})=>{const u=l.map(g=>ee(g.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:u,vertices:m,type:p},type:"update"})}}})}_getHandlesForComponent(e,t){const a=e.activeComponent;if(!a)return[];switch(a.type){case"graphic-mover":return[a.on("graphic-click",({graphic:o,viewEvent:i})=>{var r;(r=i.native)!=null&&r.shiftKey&&t.multipleSelectionEnabled&&(i.stopPropagation(),e.removeFromSelection(o))}),a.on("graphic-move-start",o=>e.addToHistory(M(o.allGraphics)))];case"box":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(e,t,o)),a.on("move-start",o=>e.addToHistory(M(o.graphics))),a.on("rotate-start",o=>e.addToHistory(M(o.graphics))),a.on("scale-start",o=>e.addToHistory(M(o.graphics)))];case"reshape":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(e,t,o)),a.on("move-start",o=>e.addToHistory(M([o.mover]))),a.on("reshape-start",o=>e.addToHistory(M([o.graphic]))),a.on("vertex-add",o=>e.addToHistory(M([o.oldGraphic]))),a.on("vertex-remove",o=>e.addToHistory(M([o.oldGraphic])))];case"move-3d":return[a.events.on("record-undo",({updates:o})=>{e.addToHistory({updates:o})}),a.events.on("move-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.objects.length>0?o.objects[0].graphic:null,type:"move-start"},type:"update"})}),a.events.on("move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:o.dx,dy:o.dy,mover:o.objects.length>0?o.objects[0].graphic:null,type:"move"},type:"update"})}),a.events.on("move-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.objects.length>0?o.objects[0].graphic:null,type:"move-stop"},type:"update"})}),a.events.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.object.graphic],e,t):e.toggleTool()})];case"transform-3d":return[a.events.on("record-undo",({updates:o})=>{e.addToHistory({updates:o})}),a.events.on("translate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-start"},type:"update"})}),a.events.on("translate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-stop"},type:"update"})}),a.events.on("rotate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,angle:o.angle,type:"rotate-start"},type:"update"})}),a.events.on("rotate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,angle:o.angle,type:"rotate-stop"},type:"update"})}),a.events.on("scale-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-start"},type:"update"})}),a.events.on("scale-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-stop"},type:"update"})}),a.events.on("translate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move"},type:"update"})}),a.events.on("rotate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,angle:o.angle,type:"rotate"},type:"update"})}),a.events.on("scale",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale"},type:"update"})}),a.events.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.object.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[a.events.on("reshape",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...o,mover:o.object.graphic},type:"update"})}),a.events.on("move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...o,mover:o.object.graphic},type:"update"})}),a.events.on("vertex-add",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.events.on("vertex-remove",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.events.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.object.graphic],e,t):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,t,a){var r;const{graphic:o,viewEvent:i}=a;return(r=i.native)!=null&&r.shiftKey&&this.hasGraphic(o)?(i.stopPropagation(),e.removeFromSelection(o)):t.toggleToolOnClick?(i.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){var i;this._operationHandle=e;const a=(i=this.view)==null?void 0:i.map;this._disablePopup(t);const o=()=>{if(e===this._operationHandle){const r=this.updateGraphics.toArray(),d=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),a&&a.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:r,state:"complete",aborted:e.cancelled,tool:d,toolEventInfo:null,type:"update"})}};e.on("complete",o)}async _getCommonUpdateOperationClickHandlers(e,t,a){const o=X(t),i=await t.defer(()=>this._getFirstHit(o));if(i==null)return void e.complete();if(t.native.shiftKey&&this._toggleSelection([i.graphic],e,a))return void t.stopPropagation();this.updateGraphics.includes(i.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,a){const o=!!a.multipleSelectionEnabled;return e.some(i=>i!=null&&!(!o||!this.hasGraphic(i))&&(this.updateGraphics.includes(i)?t.removeFromSelection(i):t.addToSelection(i),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const a=t.key;a===b.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):a===b.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):a===b.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&b.delete.includes(a)&&this._onDeleteKey(t)}_onDeleteKey(e){var o;if(!this._operationHandle||this._operationHandle.type!=="update")return;const t=this.activeComponent,a=this.updateGraphics.toArray();t!=null&&(t.type!=="reshape"||a.length===1&&((o=a[0].geometry)==null?void 0:o.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,t;this._internalGraphicsLayer&&((t=(e=this.view)==null?void 0:e.map)==null||t.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=P(this._internalGraphicsLayer))}_isComponentGraphic(e){var a;const{activeComponent:t}=this;return!(!e||t==null)&&(((a=e.attributes)==null?void 0:a.esriSketchTool)||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_clearCursor(){this.removeHandles(K)}_displayCursor(e){var t;this.removeHandles(K),(t=this.view)!=null&&t.container&&e!=null&&this.addHandles(this.view.acquireCursor(e,"high"),K)}_logError(e,t,a){Ke.getLogger(this).error(new Ze(e,t,a))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const a=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:a}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}_onLayerGraphicsChangeCallback(e){if(this._operationHandle!=null){const{updateGraphics:t}=this;for(const a of e.removed)if(t.includes(a)){if(!(t.length>1)){this._operationHandle.cancel();break}this._operationHandle.removeFromSelection(a)}}}get test(){}wait(){return te(()=>!this.updating)}_disablePopupEnabled(e){var t;return((t=this.view)==null?void 0:t.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(j(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await We(te(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",le("view"))}_logMissingLayer(){this._logError(at,le("layer"))}};c([y()],_.prototype,"_defaultSnappingManager",void 0),c([y()],_.prototype,"_layerAdapter",null),c([y()],_.prototype,"_operationHandle",void 0),c([y({readOnly:!0})],_.prototype,"_updatingHandles",void 0),c([y({readOnly:!0})],_.prototype,"activeTool",null),c([y({readOnly:!0})],_.prototype,"activeCreateToolDrawMode",null),c([y()],_.prototype,"activeTooltip",null),c([y({types:I})],_.prototype,"activeFillSymbol",void 0),c([y()],_.prototype,"activeLineSymbol",void 0),c([y()],_.prototype,"activeVertexSymbol",void 0),c([y()],_.prototype,"allowDeleteKey",void 0),c([y({readOnly:!0})],_.prototype,"createGraphic",null),c([y()],_.prototype,"defaultCreateOptions",null),c([y()],_.prototype,"defaultUpdateOptions",null),c([y({type:Ne,nonNullable:!0})],_.prototype,"labelOptions",null),c([y()],_.prototype,"layer",void 0),c([y({types:I})],_.prototype,"pointSymbol",void 0),c([y({types:I})],_.prototype,"polygonSymbol",void 0),c([y({types:I})],_.prototype,"polylineSymbol",void 0),c([y()],_.prototype,"meshSymbol",void 0),c([y()],_.prototype,"textSymbol",void 0),c([y({type:ye,nonNullable:!0})],_.prototype,"snappingOptions",null),c([y()],_.prototype,"snappingManager",null),c([y({readOnly:!0})],_.prototype,"state",null),c([y({type:ze,nonNullable:!0})],_.prototype,"tooltipOptions",null),c([y({readOnly:!0})],_.prototype,"updateGraphics",void 0),c([y()],_.prototype,"updateOnGraphicClick",void 0),c([y()],_.prototype,"updating",null),c([y()],_.prototype,"creationMode",void 0),c([y({type:Be,nonNullable:!0})],_.prototype,"valueOptions",null),c([y({types:I})],_.prototype,"vertexSymbol",void 0),c([y({value:null})],_.prototype,"view",null),c([y({constructOnly:!0,type:ue})],_.prototype,"sketchOptions",void 0),_=c([V("esri.widgets.Sketch.SketchViewModel")],_);const at="sketch:missing-property",le=e=>`Property '${e}' is missing on SketchViewModel.`;function ot(e){return e==="polygon"||e==="rectangle"||e==="circle"}function U(e,t){ve("undo",e.history.undo,e.history.redo,t)}function L(e,t){ve("redo",e.history.redo,e.history.undo,t)}function ve(e,t,a,o){const i=t.pop();if(!i)return;const r=i.updates,d=[];o.forEach((h,n)=>{const s=r[n];s!=null&&("geometry"in s&&s.geometry!=null&&(d.push({geometry:h.geometry}),h.geometry=s.geometry),"symbol"in s&&s.symbol!=null&&(d.push({symbol:h.symbol}),h.symbol=s.symbol),"undo"in s&&(d.push(s),s[e](h)))}),a.push({updates:d})}function he(e,t){e!=null&&t.hasGrabbedManipulators&&(e.activeTool=null)}function M(e){return{updates:e.map(({geometry:t})=>(t==null?void 0:t.type)==="mesh"?{geometry:t.cloneShallow()}:{geometry:t})}}function $(e,t){var a;(a=e.tools)==null||a.remove(t),t.destroyed||t.destroy()}function G(e){return"requireError"in e&&e.requireError==="aborted"}export{dt as a,_ as d,ct as l,lt as s,re as t};
