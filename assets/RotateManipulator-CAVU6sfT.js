import{ad as p,K as $,a as v,x as y,cH as f,eo as w,eI as b,eH as M,fG as O,iF as P,iG as H}from"./index-gvPOfpe8.js";import{b as T,d as _,s as D,k as g,q as j}from"./sliceToolConfig-BlPrvH8P.js";import{b as R,C as x,k,x as A}from"./SlicePlaneMaterial.glsl-KYZOjJC_.js";import{Y as C,h as B,t as h,f as G}from"./ShadedColorMaterial.glsl-SKIew8g8.js";import{g as I}from"./ImageMaterial.glsl-D95JqHph.js";let W=class extends C{constructor(e,o){const t=R(o),r=t?T:_,c=r*D,n=_,u={renderOccluded:4,isDecoration:!0},d=new p({...u,width:r},e.state.isGlobal),a=new p({...u,width:c},e.state.isGlobal),s=new p({...u,width:n},e.state.isGlobal);super({view:e,...B,...U({isCorner:t,unfocusedMaterial:d,focusedMaterial:a,outlineMaterial:s})}),this._themeHandle=$(()=>e.effectiveTheme.accentColor,m=>{const i=y.toUnitRGBA(m);d.setParameters({color:i}),a.setParameters({color:i}),s.setParameters({color:i})},v)}destroy(){this._themeHandle.remove(),super.destroy()}};function U({isCorner:l,unfocusedMaterial:e,focusedMaterial:o,outlineMaterial:t}){const r=l?[f(1,0,0),f(0,0,0),f(0,1,0)]:[f(1,0,0),f(-1,0,0)];return{renderObjects:[new h(w(e,r),1|x),new h(w(o,r),2|x),new h(w(t,r),k)],collisionType:{type:"line",paths:[r]},radius:l?g:j,state:x}}class z extends C{constructor(e,o){const t=b(e.effectiveTheme.accentColor,.5),r=M(e.effectiveTheme.accentColor),c=o(t,r),n=new I({draped:!1,texture:c.texture,writeDepth:!1,renderOccluded:16,isDecoration:!0}),u=G.calloutWidth,d=new p({width:u,renderOccluded:4,isDecoration:!0},e.state.isGlobal);super({view:e,...q({imageMaterial:n,calloutMaterial:d})}),this._material=n,this._textureHandle=c,this._themeHandle=$(()=>e.effectiveTheme.accentColor,a=>{const s=b(a,.5),m=M(a),i=this._textureHandle;this._textureHandle=o(s,m),n.setParameters({texture:this._textureHandle.texture}),i==null||i.release(),d.setParameters({color:y.toUnitRGBA(a)})},v)}destroy(){this._textureHandle=O(this._textureHandle),this._themeHandle.remove(),this._material.dispose(),super.destroy()}}function q({imageMaterial:l,calloutMaterial:e}){const{focusMultiplier:o,calloutLength:t,discRadius:r}=G,c=r*o,n=(s,m)=>{const i=[0,1,2,2,3,0];return new P(m,[["position",new H([t-s,-s,0,t+s,-s,0,t+s,s,0,t-s,s,0],i,3,!0)],["uv0",new H([0,0,1,0,1,1,0,1],i,2,!0)]])},u=w(e,[[0,0,0],[t-r,0,0]]),d=w(e,[[0,0,0],[t-c,0,0]]),a=A;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[t,0,0]},focusMultiplier:o,radius:r,renderObjects:[new h(n(r,l),1|a),new h(u,1|a),new h(n(c,l),2|a),new h(d,2|a)],state:a}}export{W as b,z as h};
