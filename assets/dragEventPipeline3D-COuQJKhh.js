import{d$ as D,a1 as m,e0 as S,e1 as w,e2 as p,e3 as E,e4 as y,e5 as $,e6 as b,aa as i,e7 as h,e8 as k,e9 as I,dc as F,ea as T,eb as U,dy as R,cI as x,ec as A,ed as K,ee as C,cK as H,ef as q,dZ as G,ac as _,ab as j}from"./index-5QWH35TG.js";import{D as z}from"./InteractiveToolBase-i3kEsRnv.js";function B(n,r){return M(n,()=>r)}function X(n){return M(n,r=>r.plane)}function M(n,r){const t=i(),l=i();let s=!1;return e=>{const u=r(e);if(e.action==="start"){const c=p(e.screenStart,E(y.get())),o=$(n.state.camera,c,g);o!=null&&(s=b(u,o,t))}if(!s)return null;const a=p(e.screenEnd,E(y.get())),d=$(n.state.camera,a,g);return d==null?null:b(u,d,l)?{...e,renderStart:t,renderEnd:l,plane:u,ray:d}:null}}function J(n,r,t=0,l=null,s=null){let e=null;return u=>{if(u.action==="start"&&(e=n.sceneIntersectionHelper.intersectElevationFromScreen(S(u.screenStart.x,u.screenStart.y),r,t,s),e!=null&&l!=null&&!w(e,e,l))||e==null)return null;const a=n.sceneIntersectionHelper.intersectElevationFromScreen(S(u.screenEnd.x,u.screenEnd.y),r,t,s);return a!=null&&(l==null||w(a,a,l))?{...u,mapStart:e,mapEnd:a}:null}}function O(n,r,t,l=null,s=null){return J(n,t,D(r,n,t),l,s)}function Y(n,r,t,l){const s=t.toMap(n.screenStart);return s!=null?O(r,s,t.elevationInfo,l):null}function Z(n,r){const t=v,l=P,s=U();n.renderCoordsHelper.worldUpAtPosition(r,t);const e=R(A(s),t,x(l,r,n.state.camera.eye));return R(e,e,t),K(r,e,s)}function ee(n,r,t){let l=null;const s=new z;return s.next(B(n,Z(n,r))).next(L(n,r)).next(N(n,t)).next(e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,l=e}),e=>(l=null,s.execute(e),l)}function L(n,r){const t=i(),l=C(r);n.renderCoordsHelper.worldUpAtPosition(r,t);const s=i(),e=i(),u=a=>(x(a,a,r),q(t,a,a),n.viewingMode==="global"&&C(a)*Math.sign(G(t,a))<.001-l&&x(a,_(a,t,.001),r),j(a,a,r),a);return a=>(a.renderStart=u(H(s,a.renderStart)),a.renderEnd=u(H(e,a.renderEnd)),a)}function ne(n,r){const t=l=>{const s=p(l,E(Q)),e=$(n.state.camera,s,g);if(e==null)return null;const u=T(r,e,v,P);return u==null?void 0:u[0]};return l=>{const s=t(l.screenStart);if(s==null)return null;const e=t(l.screenEnd);return e==null?null:{...l,renderStart:s,renderEnd:e}}}function N(n,r){const t=n.renderCoordsHelper;return l=>{const s=t.fromRenderCoords(l.renderStart,new m({spatialReference:r})),e=t.fromRenderCoords(l.renderEnd,new m({spatialReference:r}));return s!=null&&e!=null?{...l,mapStart:s,mapEnd:e}:null}}function te(n){let r=null;return t=>{switch(t.action){case"start":r=n.disableDisplay();break;case"end":case"cancel":r!=null&&(r.remove(),r=null)}return t}}function re(n,r=null){const t=new k(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=0,t.options.hud=!1;const l=S(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},e=i(),u=r??n.spatialReference,a=c=>{n.map.ground&&n.map.ground.opacity<1?s.exclude.add(I):s.exclude.delete(I),n.sceneIntersectionHelper.intersectIntersectorScreen(p(c,l),t,s);const o=t.results.min;let f;if(o.getIntersectionPoint(e))f=o.intersector===7?0:1;else{if(!t.results.ground.getIntersectionPoint(e))return null;f=0}return{location:n.renderCoordsHelper.fromRenderCoords(e,new m({spatialReference:u})),surfaceType:f}};let d;return c=>{if(c.action==="start"){const f=a(c.screenStart);d=f!=null?f.location:null}if(d==null)return null;const o=a(c.screenEnd);return(o==null?void 0:o.location)!=null?{...c,mapStart:d,mapEnd:o.location,surfaceType:o.surfaceType}:null}}const Q=F(),v=i(),P=i(),g=h();export{ne as D,te as G,O as M,re as O,B as P,X as R,ee as T,Y as k,N as q};
